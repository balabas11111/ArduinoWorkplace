<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head>
	<th:block th:replace="templates :: headImportsUp" ></th:block>
	
	<link rel="stylesheet" href="css/bootstrap-datetimepicker.min.css" />
	<link rel="stylesheet" href="chart/Chart.css">
</head>

<body>

<header th:replace="templates :: MainPageHeader(url=${baseUrl + '/virtual/devices'}, text=${'Тревога'})"></header>

	<div class="container">
		<h4 th:text="${pageHeader}"></h4>

			<table class="table table-dark table-striped">
				<tr>
					<td th:text="${alarm.description}"></td>
					<td th:text="${alarm.getPreviousAlarmState().getEmoji().toString() + ' -> ' + alarm.getAlarmState().getEmoji().toString()}">itemClass</td>
				</tr>
				<tr>
					<td>Параметр</td>
					<td th:text="${alarm.parameter}"></td>
					<td>Интервал</td>
					<td th:text="${alarm.messageInterval}"></td>
				</tr>
				<tr>
					<td>Процессор</td>
					<td>
						<th:block th:replace="templates :: IItemAbstractLabelParentChecker(items=${checkers}, selectedName=${currentCheckerName})"></th:block>
					</td>
				</tr>
				
				<tr>
					<td>Цель</td>
					<td>
						<th:block th:replace="templates :: IItemAbstractLabelAlarmTarget(items=${targets}, selectedId=${alarm.getItemId()})"></th:block>
					</td>
				</tr>
			</table>

			<div th:if="${!alarm.isNew()}">
				
				<h5>События</h5>			
									
				<table class="table table-dark table-striped">
					<thead>
						<tr>
						    <th></th>
							<th>Описание</th>
							<th>Состояние 1</th>
							<th>Состояние 2</th>
							<th>Строка</th>
							<th>Параметры строки</th>
							<th>Процессор событий</th>
						</tr>
					</thead>
					<tbody>
						<tr th:each="actionItem : ${alarm.getActionsList()}">
						    <td th:text="${actionItem.getEmoji()}"></td>
							<td th:text="${actionItem.description}"></td>
							<td th:text="${actionItem.getOldState()}"></td>
							<td th:text="${actionItem.getNewState()}"></td>
							<td th:text="${actionItem.stringFormatted}"></td>
							<td th:text="${actionItem.stringParametersFormatted}"></td>
							<td th:text="${actionItem.targetBeanName}"></td>
						</tr>
					</tbody>
				</table>
			</div>
			
			<div id="chartSection">
				<div th:replace="templates :: dateSelector"></div>
				<canvas id="chart1"></canvas>
			</div>

	</div>

	<footer th:replace="templates :: footer"></footer>
	<div th:replace="templates :: importsUp" th:remove="tag"></div>
	
	<script th:inline="javascript">
		/*<![CDATA[*/
			var currentId = /*[[${alarm.getId()}]]*/;
			var redirectPreffix = "/viewAlarm?id=";
		/*]]>*/
	</script>
		
	<th:block th:replace="templates :: importsChartUp"></th:block>
</body>

</html>